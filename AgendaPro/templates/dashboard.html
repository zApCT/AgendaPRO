{% extends 'base.html' %}
{% block content %}
<h1>Dashboard</h1>

<div class="cards">
  <div class="card">
    <div class="card-title">Appuntamenti di oggi</div>
    <div class="card-kpi">{{ todays_appts|length }}</div>
  </div>
  <div class="card">
    <div class="card-title">Appuntamenti questa settimana</div>
    <div class="card-kpi">{{ week_count }}</div>
  </div>
  <div class="card">
    <div class="card-title">Clienti totali</div>
    <div class="card-kpi">{{ clients_count }}</div>
  </div>
</div>

<h2>Oggi</h2>
<div class="list">
  {% if todays_appts %}
    {% for ap in todays_appts %}
      <div class="list-item">
        <div>
          <div class="title">{{ ap.title }}</div>
          <div class="subtitle">
            {{ ap.start_at.strftime('%H:%M') }}–{{ ap.end_at.strftime('%H:%M') }}
            {% if ap.client %} • {{ ap.client.name }}{% endif %}
            {% if ap.location %} • {{ ap.location }}{% endif %}
          </div>
        </div>
        <div>
          <a class="btn ghost" href="{{ url_for('appt_edit', appt_id=ap.id) }}">Modifica</a>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <div class="empty">Nessun appuntamento per oggi.</div>
  {% endif %}
</div>

<h2>Clienti recenti</h2>
<div class="list">
  {% for c in recent_clients %}
    <div class="list-item">
      <div>
        <div class="title">{{ c.name }}</div>
        <div class="subtitle">{% if c.email %}{{ c.email }}{% endif %}{% if c.phone %} • {{ c.phone }}{% endif %}</div>
      </div>
      <div><a class="btn ghost" href="{{ url_for('clients_detail', client_id=c.id) }}">Apri</a></div>
    </div>
  {% endfor %}
</div>

{% endblock %}

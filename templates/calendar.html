{% extends 'base.html' %}
{% block content %}
<h1>Agenda settimanale</h1>

<div class="toolbar">
  <a class="btn" href="{{ url_for('appt_new') }}">+ Nuovo appuntamento</a>
  <div class="spacer"></div>
  <a class="btn ghost" href="{{ url_for('calendar', date=prev_week) }}">← Settimana precedente</a>
  <a class="btn ghost" href="{{ url_for('calendar', date=next_week) }}">Settimana successiva →</a>
</div>

<div class="week-grid">
  {% for d in days %}
  <div class="day-col">
    <div class="day-head">{{ d.strftime('%A %d/%m') }}</div>
    <div class="day-list">
      {% if grouped[d] %}
        {% for ap in grouped[d] %}
          <div class="appt">
            <div class="appt-title">{{ ap.title }}</div>
            <div class="appt-sub">{{ ap.start_at.strftime('%H:%M') }}–{{ ap.end_at.strftime('%H:%M') }}{% if ap.client %} • {{ ap.client.name }}{% endif %}</div>
            <div class="appt-actions">
              <a class="btn tiny ghost" href="{{ url_for('appt_edit', appt_id=ap.id) }}">Modifica</a>
              <form action="{{ url_for('appt_delete', appt_id=ap.id) }}" method="post" onsubmit="return confirm('Eliminare appuntamento?');">
                <button class="btn tiny danger" type="submit">Elimina</button>
              </form>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <div class="empty small">Nessun appuntamento.</div>
      {% endif %}
    </div>
  </div>
  {% endfor %}
</div>
{% endblock %}
